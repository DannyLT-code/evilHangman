OLD, INCOMPLETE VERSION. 
WILL UPDATE AS SOON AS I CAN GET FULL WORKING VERSION BACK.